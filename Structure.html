<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>1&nbsp;Structure</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">The Grid Language (work in progress)</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Structure</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="Styles.html" class="tocviewlink" data-pltdoc="x">Styles</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>1&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Structure</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">1.1&nbsp;</td><td><a href="#%28part._.Sheets%29" class="tocviewlink" data-pltdoc="x">Sheets</a></td></tr><tr><td align="right">1.2&nbsp;</td><td><a href="#%28part._.Values_and_.Expressions%29" class="tocviewlink" data-pltdoc="x">Values and Expressions</a></td></tr><tr><td align="right">1.3&nbsp;</td><td><a href="#%28part._.References%29" class="tocviewlink" data-pltdoc="x">References</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">1.1<tt>&nbsp;</tt></span><a href="#%28part._.Sheets%29" class="tocsubseclink" data-pltdoc="x">Sheets</a></td></tr><tr><td><span class="tocsublinknumber">1.2<tt>&nbsp;</tt></span><a href="#%28part._.Values_and_.Expressions%29" class="tocsubseclink" data-pltdoc="x">Values and Expressions</a></td></tr><tr><td><span class="tocsublinknumber">1.3<tt>&nbsp;</tt></span><a href="#%28part._.References%29" class="tocsubseclink" data-pltdoc="x">References</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="index.html" title="backward to &quot;The Grid Language (work in progress)&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;The Grid Language (work in progress)&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="Styles.html" title="forward to &quot;2 Styles&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3>1<tt>&nbsp;</tt><a name="(part._.Structure)"></a>Structure</h3><h4>1.1<tt>&nbsp;</tt><a name="(part._.Sheets)"></a>Sheets</h4><p>A &lsquo;spreadsheet,&rsquo; such as an Excel spreadsheet, is a list of worksheets, each of
which is a two-dimensional array of cells. In Grid, a worksheet, or
<span class="sroman">&#8249;<span style="font-style: italic">sheet</span>&#8250;</span>, is represented as a list of rows, each of which is a list of
cells. (This is the same structure as the XML application underlying ODF.)</p><p>Spreadsheets carry some metadata along with them: author, date, and so on. We
haven&rsquo;t figured this out yet.</p><h4>1.2<tt>&nbsp;</tt><a name="(part._.Values_and_.Expressions)"></a>Values and Expressions</h4><p>In most spreadsheet programs, such as Excel, the content of a cell may be either
the literal form of a value or a formula representing a computation. Formulas
are distinguishable from values because they start with &lsquo;<span class="stt">=</span>.&rsquo;</p><p>In Grid, both values and formulas are represented by <a name="(tech._expression)"></a><span style="font-style: italic">expressions</span>. An
expression is either: an <a href="#%28tech._atomic._value%29" class="techoutside" data-pltdoc="x"><span class="techinside">atomic value</span></a>; a <a href="#%28tech._non._atomic._value%29" class="techoutside" data-pltdoc="x"><span class="techinside">non&ndash;atomic value</span></a> (see
below); or the <a href="#%28tech._application%29" class="techoutside" data-pltdoc="x"><span class="techinside">application</span></a> of a built-in function to a set of
arguments. When a Grid program is translated to a spreadsheet the expression is
converted to a value or a formula as appropriate.</p><p>An <a name="(tech._atomic._value)"></a><span style="font-style: italic">atomic value</span> is a number, a string, a boolean, an error, or
&lsquo;nothing.&rsquo; (It may be worthwhile thinking about adding other types &ndash; for
example, dates.) The special value &lsquo;nothing&rsquo; represents an empty cell. Any cells
which exist in the final spreadsheet but which were not specified in the Grid
programme (for example, cells to the right of or below those specified)
implicitly contain the value &lsquo;nothing.&rsquo;</p><p>A <a name="(tech._non._atomic._value)"></a><span style="font-style: italic">non&ndash;atomic value</span> is either a matrix value or a reference. A
<a name="(tech._matrix._value)"></a><span style="font-style: italic">matrix value</span> is a two-dimensional matrix of <a href="#%28tech._atomic._value%29" class="techoutside" data-pltdoc="x"><span class="techinside">atomic values</span></a>. A
<a href="#%28tech._reference%29" class="techoutside" data-pltdoc="x"><span class="techinside">reference</span></a> is a pointer to another cell or to a range of cells. Both array
values and references can be generated by, and consumed by, certain built-in
functions, as well as having literal forms.</p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p><span style="font-weight: bold">Excel</span>: In Excel, one can write <a href="#%28tech._matrix._value%29" class="techoutside" data-pltdoc="x"><span class="techinside">matrix values</span></a> and
<a href="#%28tech._reference%29" class="techoutside" data-pltdoc="x"><span class="techinside">references</span></a> as literals in formulas. For example, <span class="stt">={1, 2, 3; 3, 4 5}</span>
is a matrix of two rows by three columns and the function <span class="stt">SUM()</span> will take a
matrix as an argument. The formula <span class="stt">=OFFSET(A1, 0, 0)</span> includes the literal
reference <span class="stt">A1</span> and the function <span class="stt">OFFSET()</span> itself produces a reference as
its value.</p></blockquote></blockquote></blockquote><p>An <a name="(tech._application)"></a><span style="font-style: italic">application</span> represents the application of a built-in function to
arguments.</p><p>To evaluate an expression means to reduce it to a value (atomic or
non-atomic). Since errors are values and there are no unbounded loops in Grid
(at least, we assume that &ldquo;circular references&rdquo; are forbidden), the evaluation
of an expression always terminates. To evaluate a <span class="emph">cell</span> means to reduce
any value to an atomic value. The atomic value of an array value is its top-left
element, and the atomic value of a reference is the referent.</p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p><span style="font-weight: bold">Excel</span>: The behaviour of Excel when the result of a formula
is an array value has changed in recent versions. Previously, a cell whose
contents evaluated to an array would appear to contain just the top-left element
of the array. The new behaviour is that the elements of the array &lsquo;spill out&rsquo; of
the cell into adjacent cells; if these cells are not empty then a <span class="stt">#SPILL!</span>
error is reported in the cell. This change is not merely a presentational
change: a reference to a cell into which a value was spilled will now give the
spilled value whereas, previously, that cell would have been treated as empty.</p></blockquote></blockquote></blockquote><h4>1.3<tt>&nbsp;</tt><a name="(part._.References)"></a>References</h4><p><div class="SIntrapara">A <a name="(tech._range)"></a><span style="font-style: italic">range</span> of cells is a rectangular set of contiguous cells (possibly
just a single cell). </div><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p><span style="font-weight: bold">Excel</span>: In Excel, a range is allowed to
be the union of rectangular ranges.</p></blockquote></blockquote></blockquote></div></p><p>A <a name="(tech._reference)"></a><span style="font-style: italic">reference</span> is a value that denotes a range. A <a name="(tech._label)"></a><span style="font-style: italic">label</span> is a
unique identifier associated with a cell (unique over all cells). Grid uses
labels to refer to single cells; it uses two labels to refer to a range of
cells: the two labels are the top-left abd bottom-right cell respectively.</p><p>A <a name="(tech._named._range)"></a><span style="font-style: italic">named range</span> is a symbol which stands for a range. For now, Grid does
not support named ranges.</p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="index.html" title="backward to &quot;The Grid Language (work in progress)&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;The Grid Language (work in progress)&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="Styles.html" title="forward to &quot;2 Styles&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>