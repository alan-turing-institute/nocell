<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>2&nbsp;Values and Expressions</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">The Grid Language (work in progress)</a></td></tr></table></div><div class="tocviewsublistonly" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Structure.html" class="tocviewlink" data-pltdoc="x">Structure</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Values and Expressions</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="References.html" class="tocviewlink" data-pltdoc="x">References</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="Styles.html" class="tocviewlink" data-pltdoc="x">Styles</a></td></tr></table></div></div></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="Structure.html" title="backward to &quot;1 Structure&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;The Grid Language (work in progress)&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="References.html" title="forward to &quot;3 References&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3>2<tt>&nbsp;</tt><a name="(part._.Values_and_.Expressions)"></a>Values and Expressions</h3><p>In most spreadsheet programs, such as Excel, the content of a cell may be either
the literal form of an <a name="(tech._atomic._value)"></a><span style="font-style: italic">atomic value</span> (specifically, a number, string,
boolean, or error) or a &lsquo;formula,&rsquo; representing a computation. Formulas are
distinguishable from atomic values because they start with &lsquo;<span class="stt">=</span>.&rsquo;</p><p>In Grid, both atomic values and formulas are represented by
<a name="(tech._expression)"></a><span style="font-style: italic">expressions</span>. An expression may be an atomic value, a non&ndash;atomic
value, or the application of a built-in function to a set of arguments. When a
Grid program is converted to a spreadsheet the expression is converted to an
atomic value or a formula as appropriate.</p><p>A non&ndash;atomic value is either an array value or a reference. An <a name="(tech._array._value)"></a><span style="font-style: italic">array
value</span> is a two-dimensional matrix of atomic values. (Note that array values
cannot contain non&ndash;atomic values as their elements.) A <a name="(tech._reference)"></a><span style="font-style: italic">reference</span> is a
pointer to another cell in the same spreadsheet. Both kinds of value can be
generated by, and consumed by, certain built-in functions.</p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>In Excel, one can write array values and references as literals in
formulas. For example, <span class="stt">={1, 2, 3; 3, 4 5}</span> is an array of two rows and three
columns and the function <span class="stt">SUM()</span> will take an array as an argument. The
formula <span class="stt">=OFFSET(A1, 0, 0)</span> includes the literal reference <span class="stt">A1</span> and the
function <span class="stt">OFFSET()</span> itself produces a reference as its value.</p></blockquote></blockquote></blockquote><p>To <span class="emph">evaluate</span> a spreadsheet means to evaluate each expression to produce an
atomic value. If the final value of an expression in a cell is a non&ndash;atomic
value, the result of the cell (as &lsquo;seen by&rsquo; any other cell through a reference)
will be the top-left value in the array value.</p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>The behaviour of Excel when the result of a formula is an array
value has changed in recent versions. Previously, a cell whose contents
evaluated to an array would appear to contain just the top-left element of the
array. However, the new behavoiur is that the elements of the array &lsquo;spill&rsquo; out
of the cell into adjacent cells; if these cells are not empty then a
<span class="stt">#SPILL!</span> error is reported in the cell. This change is not merely a
presentational change since a reference to a cell into which a value was spilled
will now give the spilled value; whereas, previously, that cell would have been
treated as empty.</p></blockquote></blockquote></blockquote><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="Structure.html" title="backward to &quot;1 Structure&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;The Grid Language (work in progress)&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="References.html" title="forward to &quot;3 References&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>